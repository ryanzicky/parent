### Mysql主从集群
    通过搭建Mysql主从集群，可以缓解Mysql的数据库存储以及访问的压力
    1. 数据安全
        给主服务增加一个数据备份
    2. 都多写少
        对于大部分的Java程序来说，都是读多写少的，读请求远远高于写请求。
        实现读写分离需要一些中间件支持，例如ShaedingSphere
    3. 故障转移-高可用
        当Mysql主服务宕机后，可以由一台从服务切换成主服务，继续提供数据读写功能
        如果数据库访问压力不那么大，那读写分离不一定是必要的
    
### 同步的原理
    Mysql服务的主从架构一般是通过binlog日志文件来进行的，即在主服务上打开binlog
    记录每一步的数据库操作，然后从服务商会有一个IO线程，负责跟主服务建立一个TCP连接，
    请求主服务将binlig传输过来。这时主服务有一个dump线程，负责通过这个TCP连接把
    binlog日志传输给从数据的IO线程，接着从服务的IO线程会把读取到的binlog日志数据
    写入到自己的relay日志文件中，然后从服务上另外一个sql线程会读取relay日志里的内容，
    进行操作重演，达到数据同步的目的。

    Mysql的binlog不光可以用于主从同步，还可以用于缓存数据同步等场景
    例如Canal，可以模拟一个slave节点，向Mysql发起binlog同步，然后将数据落地到
    Redis，Kafka等组件，实现数据实时流转

### 半同步复制
    1. 理解半同步复制
        Mysql主从集群默认采用的是一种异步复制的机制，主服务在执行用户提交的事务后，
        写入binlog日志，然后就给客户端返回一个成功的响应，而binlog会由一个dump
        线程异步发送给slave从服务

        由于异步，主服务向客户端返回执行结果时，是不知道从服务是否同步成功了的，
        这时如果主服务宕机了，而从服务还没有备份到新执行的binlog，那就有可能会
        丢数据
        
        用Msyql的半同步复制机制来保证数据安全
        
        半同步复制机制是一种界于异步复制和全同步复制之间的机制，主库在执行完客户端
        提交的事务后，并不是立即返回客户端响应，而是等待至少一个从库接收并写入到
        relay log文件中，才会返回给客户端，Mysql在等待确认时，默认会等10秒，
        如果超过10秒没有收到ack，就会降级为异步复制

### 主从架构数据延迟问题
    面向业务的主服务数据都是多线程并发写入的，而从服务是单个线程慢慢拉取binlog的，
    这中间就会有个效率差，所以解决这个问题的关键就是让从服务也有多线程并行复制
    binlog数据

### Mysql集群高可用方案
    1. MMM
        (Master-Master replication managerfot Mysql，Mysql主主复制管理器)
        需要两个Master，同一时间只有一个Master对外提供服务，可以说是主备模式
        通过一个VIP(虚拟IP)的机制来保证集群的高可用，整个集群中，在主节点上会通过
        一个VIP地址来提供数据读写服务，而当出现故障时，VIP就会从原理的主节点漂移
        到从节点，由其他节点提供服务
    2. MHA
        MHA需要单独部署，分为Manager和Nod节点，两种节点，其中Manager节点一般是
        单独部署的一台机器，而Node节点一般是部署在每天Mysql机器上，Node节点通过
        解析各个Mysql的日志进行操作
    3. MGR
        MGR是Mysql在5.7.17版本后正式推出的一种组复制机制。主要解决传统异步复制和
        半同步复制的一致性问题
        支持多主模式

    共同点:
        1. 对主从复制集群中的Master节点进行监控
        2. 自动的对Master进行迁移，通过VIP
        3. 重新配置集群中的其他Slave对新的Master进行同步

### 分库分表
    分库分表是为了解决由于数据量过大而导致数据库性能降低的问题，将原来独立的数据库
    拆分成若干个数据库组成，将数据库大表拆分成若干数据库表组成，使得单一数据库，单一
    数据表的数据量变小，从而达到提升数据库性能的目的
    
    分库分表包含分库和分表两个部分，这两个部分都可以统称为分片，其目的都是将数据拆分
    成不同的存储单元，从分拆的角度下，可以分为垂直分片和水平分片
    
    分库分表缺点:
        1. 事务一致性问题
        2. 跨节点关联查询问题
        3. 跨节点分页，排序函数
        4. 主键避重问题
        5. 公共表处理
        6. 运维工作量

    什么时候需要分库分表？
        Mysql单表达到500w或者单表容量达到2GB。
    
    常见的分库分表组件
        ShardingSphere
        MyCat