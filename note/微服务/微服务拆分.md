## 1. 电商项目微服务架构拆分

#### 1. 拆分的目的：将复杂的问题简单化

**单体优势**

 	1. 公司业务处于刚开始阶段
 	2. 开发简单直接，代码和项目集中式管理
 	3. 排查问题时只需要排查这个应用就可以了，根据针对性
 	4. 只需要维护一个工程，节省维护系统运行的人力成本

**单体劣势**

1.  伴随着公司业务功能越来越多，开发团队的规模越来越大
2.  在技术层面，数据库的连接数成为应用服务器扩容的瓶颈
3.  单体架构增加了研发的成本抑制了研发效率的提升
4.  单体架构对于系统的运维也会有很大的影响



#### 微服务能解决的问题：

	1. 快速迭代
	2. 三高

**微服务拆分时机**

	1. 代码维护困难，几百人同时开发一个模块，提交代码频繁出现大量冲突
	2. 模块耦合严重，互相依赖，小功能修改也必须累计到大版本才能上线，上线还需要总监协调各个团队开会确定
	3. 横向扩展流程复杂，主要业务和次要业务耦合。例如下单和支付业务需要扩容，而注册不需要扩容

**微服务拆分的一些通用原则**

```
1.单一服务内部功能高内聚低耦合：
    每个服务只完成自己职责内的任务，对于不是自己职责的功能交给其它服务来完成
2.闭包原则(CCP)：
    微服务的闭包原则就是当我们需要改变一个微服务的时候，所有依赖都在这个微服务的组件内，
    不需要修改其它微服务
3.服务自治，接口隔离原则：
    尽量消除对其他服务的强依赖，这样可以降低沟通成本，提升服务稳定性。服务通过标准的接口隔离，
    隐藏内部实现细节。这使得服务可以独立开发，测试，部署，运行，以服务为单位持续交付。
4. 持续演进原则：
    在服务拆分的初期，你其实很难确定服务究竟要拆成什么样。应逐步划分，持续演进，避免服务数量的爆炸性增长
5. 拆分的过程尽量避免影响产品的日常功能迭代：
6. 服务接口的定义要具备可扩展性：
7. 避免环形依赖与双向依赖：
8. 阶段性合并：
9. 自动化驱动：
```

**功能拆分策略：**

​	大的原则是基于业务负责度拆分服务：业务复杂度足够高，应该基于领域驱动拆分服务。业务复杂度较低，选择基于数据驱动拆分服务

```
1. 基于数据驱动拆分服务：自下而上的架构设计方法，通过分析需求，确定整体数据结构，根据表之间的关系拆分服务
	拆分步骤：需求分析，抽象数据结构，划分服务，确定调用关系和业务流程验证。
2. 基于领域驱动拆分服务：自上而下的架构设计方法，通过和领域专家建立统一的语言，不断交流，确定关键业务场景，逐步确定边界上下文。领域驱动更强调业务实现效果，认为自下而上的设计可能会导致技术人员不能更好地理解业务方向，进而偏离业务目标。
	拆分步骤：通过模型和领域专家建立统一语言，业务分析，寻找聚合，确定服务调用关系，业务流程验证和持续优化。
3. 从已有单体交媾中逐步拆分服务
	拆分步骤：前后端分离，提取公共基础服务(如单点登录)，不断从老系统抽取服务，垂直划分优先，适当水平切分
```

**非功能维度拆分策略**

​	主要考虑六点包括：

 	1. 扩展性：
 	2. 复用性：
 	3. 高性能：
 	4. 高可用：
 	5. 安全性：
 	6. 异构性：

**Spring Cloud技术栈选型**

 	1. Spring Cloud的几大痛点：
      	1. Spring Cloud部分组件停止维护和更新，给开发带来不便
      	2. Spring Cloud部分环境搭建复杂，没有完善的可视化界面，我们需要大量的二次开发和定制
      	3. Spring Cloud配置复杂，难以上手，部分配置差别难以区分和合理应用
	2. Spring Cloud Alibaba的优势：
    	1. 阿里使用过的组件经历了考验，性能强悍，设计合理，现在开源出来大家用成套的产品搭配完善的可视化界面给开发运维带来极大的便利
    	2. 搭建简单，学习曲线低

​		

